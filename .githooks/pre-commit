#!/bin/sh
#
# Pre-commit hook to run security audit
#

set -e

echo "ğŸ”’ Running security audit..."

# Check if cargo-audit is installed
if ! command -v cargo-audit &> /dev/null; then
    echo "âš ï¸  cargo-audit not found. Installing..."
    cargo install cargo-audit
fi

# Run security audit
if cargo audit; then
    echo "âœ… Security audit passed!"
else
    echo "âŒ Security audit failed!"
    echo ""
    echo "ğŸ’¡ To fix security issues:"
    echo "   - Review the vulnerabilities listed above"
    echo "   - Update dependencies with: cargo update"
    echo "   - Check for alternative crates if needed"
    echo ""
    echo "âš ï¸  Commit blocked due to security vulnerabilities"
    exit 1
fi
